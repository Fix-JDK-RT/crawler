Stack Overflow
Log In
Sign Up
current community

            Stack Overflow
        
help
chat

            Meta Stack Overflow
        

your communities            
Sign up or log in to customize your list.
                
more stack exchange communities
company blog

                            Tour
                            
                                Start here for a quick overview of the site
                            

                        Help Center
                        
                            Detailed answers to any questions you might have
                        

                                Meta
                                
                                    Discuss the workings and policies of this site
                                

                                About Us
                                
                                    Learn more about Stack Overflow the company
                                

                                Business
                                
                                    Learn more about hiring developers or posting ads with us
                                

                    By using our site, you acknowledge that you have read and understand our Cookie Policy, Privacy Policy, and our Terms of Service.
                

        StackExchange.ready(function () { StackExchange.topbar.init({ observeSize: true }); });
        StackExchange.scrollPadding.setPaddingTop(50, 10);     
 

Home        
Public
 Stack Overflow

Tags        

Users        

Jobs        

                                            Teams
                                        
Create Team
Q&A for work. A dedicated place to share your team’s knowledge.

    StackExchange.ready(function () {
        StackExchange.Notice.tooltipInit();
    });
.everyoneloves__top-leaderboard:empty,.everyoneloves__mid-leaderboard:empty,.everyoneloves__bot-mid-leaderboard:empty{                height:90px;width:728px;box-sizing:border-box;
}
 
Why do these snippets of JavaScript behave differently even though they both encounter an error?

            Ask Question
        
69
10
var a = {}
var b = {}

try{
  a.x.y = b.e = 1 // Uncaught TypeError: Cannot set property 'y' of undefined
} catch(err) {
  console.error(err);
}
console.log(b.e) // 1
var a = {}
var b = {}

try {
  a.x.y.z = b.e = 1 // Uncaught TypeError: Cannot read property 'y' of undefined
} catch(err) {
  console.error(err);
}

console.log(b.e) // undefined
javascript
share|improve this question
edited yesterday
Ian Kemp
16.8k126999
 

        asked yesterday
Kevin AskinKevin Askin
33637
3
@NinaScholz: I don't understand. There is no syntax error; so I would assume that b.z = 1 and b.e = 1 execute first (given right-associativity on =), then a.x.y.z = ... execute and fail; why does b assignment pass in one case but not in the other?
                
                    – Amadan
yesterday
3
@NinaScholz We agree that the property y does not exist on a.x; but that is true in both cases. Why does it prevent the right-hand-side assignment in the second case but not the first? What is different in the order of execution? (I mentioned Syntax error because the timing on the syntax error is very different from that of a runtime error.)
                
                    – Amadan
yesterday
@Amadan after running code you will get error, and than use than type variable name again to see value
                
                    – Code Maniac
yesterday
2
Found this describe how Javascript proceed assignment operation ecma-international.org/ecma-262/5.1/#sec-11.13
                
                    – Solomon Tam
yesterday
What do you think the difference is? Did you try to reason this out before asking? What did your research turn up? In other words, did you do your homework before asking?
                
                    – jpmc26
1 hour ago
add a comment | 
 

                                3 Answers
                            3

            active

            oldest

            votes
109
Actually, if you read the error message properly, case 1 and case 2 throw different errors.
Case a.x.y:
Cannot set property 'y' of undefined
Case a.x.y.z:
Cannot read property 'y' of undefined
I guess it's best to describe it by step-by-step execution in easy English.
Case 1
// 1. Declare variable `a`
// 2. Define variable `a` as {}
var a = {}

// 1. Declare variable `b`
// 2. Define variable `b` as {}
var b = {}

try {

  /**
   *  1. Read `a`, gets {}
   *  2. Read `a.x`, gets undefined
   *  3. Read `b`, gets {}
   *  4. Set `b.z` to 1, returns 1
   *  5. Set `a.x.y` to return value of `b.z = 1`
   *  6. Throws "Cannot **set** property 'y' of undefined"
   */
  a.x.y = b.z = 1
  
} catch(e){
  console.error(e.message)
} finally {
  console.log(b.z)
}
Case 2
// 1. Declare variable `a`
// 2. Define variable `a` as {}
var a = {}

// 1. Declare variable `b`
// 2. Define variable `b` as {}
var b = {}

try {

  /**
   *  1. Read `a`, gets {}
   *  2. Read `a.x`, gets undefined
   *  3. Read `a.x.y`, throws "Cannot **read** property 'y' of undefined".
   */
  a.x.y.z = b.z = 1
  
} catch(e){
  console.error(e.message)
} finally {
  console.log(b.z)
}
In comments, Solomon Tam found this ECMA documentation about assignment operation.
share|improve this answer 
edited yesterday
 

        answered yesterday
Yong QuanYong Quan
2,4742927
add a comment | 
 
45
The order of operations is clearer when you exploit the comma operator inside bracket notation to see which parts are executed when:
var a = {}
var b = {}

try{
 // Uncaught TypeError: Cannot set property 'y' of undefined
  a
    [console.log('x'), 'x']
    [console.log('y'), 'y']
    = (console.log('right hand side'), b.e = 1);
} catch(err) {
  console.error(err);
}
console.log(b.e) // 1
var a = {}
var b = {}

try {
  // Uncaught TypeError: Cannot read property 'y' of undefined
  a
    [console.log('x'), 'x']
    [console.log('y'), 'y']
    [console.log('z'), 'z']
    = (console.log('right hand side'), b.e = 1);
} catch(err) {
  console.error(err);
}

console.log(b.e) // undefined
Looking at the spec:
The production AssignmentExpression : LeftHandSideExpression = AssignmentExpression is evaluated as follows:
Let lref be the result of evaluating LeftHandSideExpression.
Let rref be the result of evaluating AssignmentExpression.
Let rval be GetValue(rref).
Throw a SyntaxError exception if... (irrelevant)
Call PutValue(lref, rval).
PutValue is what throws the TypeError:
Let O be ToObject(base).
If the result of calling the [[CanPut]] internal method of O with argument P is false, then
a. If Throw is true, then throw a TypeError exception.
Nothing can be assigned to a property of undefined - the [[CanPut]] internal method of undefined will always return false.
In other words: the interpreter parses the left-hand side, then parses the right-hand side, then throws an error if the property on the left-hand side can't be assigned to.
When you do
a.x.y = b.e = 1
The left hand side is successfully parsed up until PutValue is called; the fact that the .x property evaluates to undefined is not considered until after the right-hand side is parsed. The interpreter sees it as "Assign some value to the property "y" of undefined", and assigning to a property of undefined only throws inside PutValue.
In contrast:
a.x.y.z = b.e = 1
The interpreter never gets to the point where it tries to assign to the z property, because it first must resolve a.x.y to a value. If a.x.y resolved to a value (even to undefined), it would be OK - an error would be thrown inside PutValue like above. But accessing a.x.y throws an error, because property y cannot be accessed on undefined.
share|improve this answer 
edited yesterday
 

        answered yesterday
CertainPerformanceCertainPerformance
86.3k154673
18
Nice comma operator trick--never thought to use it that way (for debugging only, of course)!
                
                    – ecraig12345
yesterday
2
s/parse/evaluate/
                
                    – Bergi
yesterday
add a comment | 
 
0
Consider the following examples and try to answer the simple questions:
var a = {}; a.x = 1;
Does the engine need to access x? No – having a reference of a is sufficient for setting the property x.
Does the engine evaluate right hand side? Yes.
Does the assignment work? Yes.
var a = {}; a.x.y = 1;
Does the engine need to access x? Yes – it needs a reference to x so that it can set the property y.
Does the engine throw an error if x is not set? No – it simple returns undefined.
Does the engine need to access y? No – see previous example.
Does the engine evaluate right hand side? Yes.
Does the assignment work? No – on the left hand side you have a reference (undefined) and a target property name (y) and you cannot set a property on undefined.
Note that the behavior has little to do with assignment operator:
[Step 1.] a. Let lref be the result of evaluating LeftHandSideExpression.
The above seems to suggest that evaluating a.x.y should throw the error in the first place. But it does not because the property accessor is evaluated as:
MemberExpression : MemberExpression . IdentifierName
Let baseReference be the result of evaluating MemberExpression.
Let baseValue be GetValue(baseReference).
ReturnIfAbrupt(baseValue).
Let bv be RequireObjectCoercible(baseValue).
ReturnIfAbrupt(bv).
Let propertyNameString be StringValue of IdentifierName
If the code matched by the syntactic production that is being evaluated is strict mode code, let strict be true, else let strict be
  false.
Return a value of type Reference whose base value is bv and whose referenced name is propertyNameString, and whose strict reference flag
  is strict.
Notice that the IdentifierName (the portion on the right side of dot) is not evaluated.
share|improve this answer 

        answered 10 hours ago
Salman ASalman A
180k66339431
add a comment | 
 
Your Answer

            StackExchange.ifUsing("editor", function () {
                StackExchange.using("externalEditor", function () {
                    StackExchange.using("snippets", function () {
                        StackExchange.snippets.init();
                    });
                });
            }, "code-snippets");
        

    StackExchange.ready(function() {
        var channelOptions = {
            tags: "".split(" "),
            id: "1"
        };
        initTagRenderer("".split(" "), "".split(" "), channelOptions);
       
        StackExchange.using("externalEditor", function() {
                // Have to fire editor after snippets, if snippets enabled
                if (StackExchange.settings.snippets.snippetsEnabled) {
                    StackExchange.using("snippets", function() {
                        createEditor();
                    });
                }
                else {
                    createEditor();
                }
            });

            function createEditor() {
                StackExchange.prepareEditor({
                    heartbeatType: 'answer',
                    autoActivateHeartbeat: false,
                    convertImagesToLinks: true,
                noModals: true,
                showLowRepImageUploadWarning: true,
                reputationToPostImages: 10,
                bindNavPrevention: true,
                postfix: "",
                imageUploader: {
                    brandingHtml: "Powered by \u003ca class=\"icon-imgur-white\" href=\"https://imgur.com/\"\u003e\u003c/a\u003e",
                    contentPolicyHtml: "User contributions licensed under \u003ca href=\"https://creativecommons.org/licenses/by-sa/3.0/\"\u003ecc by-sa 3.0 with attribution required\u003c/a\u003e \u003ca href=\"https://stackoverflow.com/legal/content-policy\"\u003e(content policy)\u003c/a\u003e",
                    allowUrls: true
                },
                    onDemand: true,
                    discardSelector: ".discard-answer"
                    ,immediatelyShowMarkdownHelp:true
                    });
                

        }
    });
Thanks for contributing an answer to Stack Overflow!Please be sure to answer the question. Provide details and share your research!But avoid …Asking for help, clarification, or responding to other answers.Making statements based on opinion; back them up with references or personal experience.To learn more, see our tips on writing great answers.
draft saved
draft discarded
Sign up or log in

                            StackExchange.ready(function () {
                                StackExchange.helpers.onClickDraftSave('#login-link');
                            });
                        
 Sign up using Google
                        
 Sign up using Facebook
                        
 Sign up using Email and Password
                        
Post as a guest
Name
Email
Required, but never shown

                StackExchange.ready(
                    function () {
                        StackExchange.openid.initPostLogin('.new-post-login', 'https%3a%2f%2fstackoverflow.com%2fquestions%2f54646467%2fwhy-do-these-snippets-of-javascript-behave-differently-even-though-they-both-enc%23new-answer', 'question_page');
                    }
                );
            
Post as a guest
Name
Email
Required, but never shown

Post Your Answer                                    

                                        Discard
                                    

                                            By clicking "Post Your Answer", you acknowledge that you have read our updated terms of service, privacy policy and cookie policy, and that your continued use of the website is subject to these policies.

Not the answer you're looking for?                            Browse other questions tagged javascript  or ask your own question.                        
asked
yesterday
viewed
4,270 times
active
today
;try{(function(a){function b(a){return'string'==typeof a?document.getElementById(a):a}function c(a){return a=b(a),!!a&&'none'===getComputedStyle(a).display}function d(a){return!c(a)}function e(a){return!!a}function f(a){return /^\s*$/.test(b(a).innerHTML)}function g(a){var b=a.style;b.height=b.maxHeight=b.minHeight='auto',b.display='none',[].forEach.call(a.children,g)}function h(a,b){var c;return function(){return a&&(c=a.call(b||this,arguments),a=null),c}}function i(a){var b=document.createElement('script');b.src=a,document.body.appendChild(b)}function j(a){return k([],a)}function k(a,b){return a.push=function(a){return b(),delete this.push,this.push(a)},a}function l(){try{return!new Function('return async()=>{};')}catch(a){return!0}}function m(){return'undefined'!=typeof googletag&&!!googletag.apiReady}function n(){m()||(googletag={cmd:j(A)})}function o(){var a=document.createElement('div');a.className='adsbox',a.id='clc-abd',a.style.position='absolute',a.style.pointerEvents='none',a.innerHTML='&nbsp;',document.body.appendChild(a)}function p(a){var b=a.serviceName,c=a.slot,d=a.lineItemId;try{var e=c.getSlotElementId(),f=[];e||f.push('id=0');var h=document.getElementById(e);if(!e||h?h.hasAttribute('data-clc-stalled')&&f.push('st=1'):f.push('el=0'),0!==f.length)return void B(f.join('&'));-1===x.dh.indexOf(d)?h.setAttribute('data-clc-prefilled','true'):g(h),h.setAttribute('data-clc-ready','true')}catch(a){var i=document.querySelector('#dfp-tsb, #dfp-isb, #clc-tsb');i&&i.setAttribute('data-clc-ready','true'),B('e=1')}}function q(){return Object.keys(F.ids)}function r(a){var b=F.ids[a],c=F.slots[b];'function'==typeof c&&(c=c(a));return{path:'/'+C+'/'+E+'/'+b+'/'+D,sizes:c,zone:b}}function s(a){return!(clc.collapse&&void 0!==clc.collapse[a])||!!clc.collapse[a]}function t(a,b){'dfp-isb'===a&&b.setTargeting('Sidebar',['Inline']),'dfp-tsb'===a&&b.setTargeting('Sidebar',['Right']);var c=r(a),d=c.path,e=c.sizes,f=c.zone,g=googletag.defineSlot(d,e,a);s(f)&&g.setCollapseEmptyDiv(!0,!0),g.addService(b),!1}function u(b){var c=a.dfp&&a.dfp.targeting||{};Object.keys(c).forEach(function(a){b.setTargeting(a,c[a])})}function v(a){var g=a.map(b).filter(e);return{eligible:g.filter(f).filter(d).map(function(a){return a.id}),ineligible:g.filter(c)}}function w(b){if(void 0===b&&(b=q()),!m())return n(),void googletag.cmd.push(function(){return w(b)});var c=v(b),d=c.eligible,e=c.ineligible;if(e.forEach(g),0!==d.length){o(),googletag.destroySlots();var f=googletag.pubads();f.enableSingleRequest(),a.sreEvent||(f.addEventListener('slotRenderEnded',p),a.sreEvent=!0),u(f),d.forEach(function(a){return t(a,f)}),googletag.enableServices(),d.forEach(function(a){googletag.display(a)})}}var x=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d,e=0,f=b;e<f.length;e++)for(var g in d=f[e],d)a[g]=d[g];return a}({"lib":"https://cdn.sstatic.net/clc/clc.min.js?v=d926a9d0eedc","style":"https://cdn.sstatic.net/clc/styles/clc.min.css?v=768595a6d237","u":"https://clc.stackoverflow.com/markup.js","wa":true,"kt":2000,"tto":true,"h":"clc.stackoverflow.com","allowed":"^(((talent\\.)?stackoverflow)|(blog\\.codinghorror)|(serverfault|askubuntu)|([^\\.]+\\.stackexchange))\\.com$","wv":true,"al":false,"dh":[4385506061,4386578282,4386579572]},a.options||{}),y=h(function(){var a=x.lib;l()&&(a=a.replace(/(\.min)?\.js(\?v=[0-9a-fA-F]+)?$/,'.ie$1.js$2')),i(a)}),z=a.cmd||[];Array.isArray(z)&&(0<z.length?y():k(z,y));var A=h(function(){i('https://www.googletagservices.com/tag/js/gpt.js')}),B=function(a){new Image().src='https://'+x.h+'/stalled.gif?'+a},C='248424177',D=/^\/tags\//.test(location.pathname)||/^\/questions\/tagged\//.test(location.pathname)?'tag-pages':'question-pages',E=location.hostname;var F={slots:{lb:[[728,90]],mlb:[[728,90]],smlb:[[728,90]],bmlb:[[728,90]],sb:function(a){return'dfp-tsb'===a?[[300,250],[300,600]]:[[300,250]]},"tag-sponsorship":[[730,135]],"mobile-below-question":[[320,50],[300,250]]},ids:{"dfp-tlb":'lb',"dfp-mlb":'mlb',"dfp-smlb":'smlb',"dfp-bmlb":'bmlb',"dfp-tsb":'sb',"dfp-isb":'sb',"dfp-tag":'tag-sponsorship',"dfp-m-aq":'mobile-below-question',"clc-tlb":'lb',"clc-mlb":'mlb',"clc-smlb":'smlb',"clc-bmlb":'bmlb',"clc-tsb":'sb'}};(function(){var b=x.al;b&&z.push(function(){return a.load()})})(),n(),a.dfp={load:w},a.options=x,a.cmd=z})(this.clc=this.clc||{})}catch(a){window.console.error(a)} 
                var clc = clc || {};
                clc.collapse = { sb: !0,'tag-sponsorship':!0,lb:!1,mlb:!1,smlb:!1,bmlb:!1,'mobile-below-question':!0};
                clc.cmd = clc.cmd || [];
                clc.cmd.push(function () { window.clc_request='ApeXdkPzkdYIAAAAAMPWQQMCAAAAAgAAAAAMAAAAfGphdmFzY3JpcHR8AI9sVQe1YluHuXY'; clc.load(); });
                                clc.dfp = clc.dfp || {};
                clc.dfp.targeting = {Registered:['false'],'so-tag':['javascript']};
                
                var googletag = googletag || {};
                googletag.cmd = googletag.cmd || [];
                googletag.cmd.push(function () { clc.dfp.load(); });
            
Related
209Test if something is not undefined in JavaScript84JavaScript - cannot set property of undefined3Encountered Error regarding bootstrap-alert.js in javascript195Google MAP API Uncaught TypeError: Cannot read property 'offsetWidth' of null398Why does jQuery or a DOM method such as getElementById not find the element?8Drag & Drop doenst not work: 'dropEffect' of undefined0Whats wrong with backbone this time?194React - uncaught TypeError: Cannot read property 'setState' of undefined0Unable to handle errors in javascript promise-1Magento Bundle Product detail page have javascript errors

            Hot Network Questions
        

                    Why doesn't Russia build more missile defense systems instead of complaining about NATO's systems?
                

                    Why do these snippets of JavaScript behave differently even though they both encounter an error?
                

                    How does the Misty Step spell interact with a mount?
                

                    GM Considerations for a Human Barbarian Toddler PC
                

                    Examples of operating systems using hardware task switching of x86 CPUs
                

                    Monitor/screen that blanks due to static electricity in my chair
                

                    Can a malware power on a computer?
                

                    What was the first science fiction story set to the future without bothering about the present?
                

                    Should I expect a company with which I've interviewed to inform me if my application has been declined?
                

                    What low-level arcane spells are directly relevant to combat where my spellcasting ability score doesn't matter?
                

                    What happens when I reanimate a creature with protection from black with Animate Dead?
                

                    Why bother programming facial expressions for artificial intelligence if humans are bad at recognising them?
                

                    How to indicate obscurity in a translated quotation?
                

                    Dallas transfer immigration stamps
                

                    QGIS 3.4 : Add points to exact locations?
                

                    Novel where Earth is conquered by a group of aliens and humans are used as fighters
                

                    cp works differently on a Mac
                

                    How can I make my Goldbach's conjecture algorithm faster?
                

                    Using LinearSolve instead of Inverse does not give a good enough precision
                

                    Examples of Magic Cards that use rule 115.2c
                

                    How to define multiple functions in the same diagram?
                

                    Is it bad to have index space larger than data space?
                

                    What’s a word that means deflect blame?
                

                    How to include front end developers and QA into the estimation process?
                

            more hot questions
        

        question feed
    
StackExchange.ready(function(){$.get('/posts/54646467/ivc/b3d0');});
default
Stack Overflow
Questions
Jobs
Developer Jobs Directory
Salary Calculator
Help
Mobile
Products
Teams
Talent
Engagement
Enterprise
Company
About
Press
Work Here
Legal
Privacy Policy
Contact Us
Stack Exchange Network
Technology
Life / Arts
Culture / Recreation
Science
Other
Stack Overflow
Server Fault
Super User
Web Applications
Ask Ubuntu
Webmasters
Game Development
TeX - LaTeX
Software Engineering
Unix & Linux
Ask Different (Apple)
WordPress Development
Geographic Information Systems
Electrical Engineering
Android Enthusiasts
Information Security
Database Administrators
Drupal Answers
SharePoint
User Experience
Mathematica
Salesforce
ExpressionEngine® Answers
Stack Overflow em Português
Blender
Network Engineering
Cryptography
Code Review
Magento
Software Recommendations
Signal Processing
Emacs
Raspberry Pi
Stack Overflow на русском
Programming Puzzles & Code Golf
Stack Overflow en español
Ethereum
Data Science
Arduino
Bitcoin

                            more (30)
                        
Photography
Science Fiction & Fantasy
Graphic Design
Movies & TV
Music: Practice & Theory
Worldbuilding
Seasoned Advice (cooking)
Home Improvement
Personal Finance & Money
Academia
Law

                            more (15)
                        
English Language & Usage
Skeptics
Mi Yodeya (Judaism)
Travel
Christianity
English Language Learners
Japanese Language
Arqade (gaming)
Bicycles
Role-playing Games
Anime & Manga
Puzzling
Motor Vehicle Maintenance & Repair

                            more (33)
                        
MathOverflow
Mathematics
Cross Validated (stats)
Theoretical Computer Science
Physics
Chemistry
Biology
Computer Science
Philosophy

                            more (10)
                        
Meta Stack Exchange
Stack Apps
API
Data
Area 51
Blog
Facebook
Twitter
LinkedIn

site design / logo © 2019 Stack Exchange Inc; user contributions licensed under cc by-sa 3.0
                            with attribution required.
                    rev 2019.2.13.32891
StackExchange.ready(function () { StackExchange.responsiveness.addSwitcher(); })
Stack Overflow works best with JavaScript enabled
            

            (function(i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            StackExchange.ready(function () {

                StackExchange.ga.init({
                    sendTitles: true,
                    tracker: window.ga,
                    trackingCodes: [
                        'UA-108242619-1'
                    ]
                });



                    StackExchange.ga.setDimension('dimension2', '|javascript|');

                    StackExchange.ga.setDimension('dimension3', 'Questions/Show');


                StackExchange.ga.trackPageView();
            });
            
/**/
            
            var _qevents = _qevents || [],
            _comscore = _comscore || [];
            (function() {
                var ssl = 'https:' == document.location.protocol,
                    s = document.getElementsByTagName('script')[0],
                    qc = document.createElement('script');
                 qc.async = true;
                    qc.src = (ssl ? 'https://secure' : 'http://edge') + '.quantserve.com/quant.js';
                    s.parentNode.insertBefore(qc, s);
                    _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
/**/
                 var sc = document.createElement('script');
                    sc.async = true;
                    sc.src = (ssl ? 'https://sb' : 'http://b') + '.scorecardresearch.com/beacon.js';
                    s.parentNode.insertBefore(sc, s);
                    _comscore.push({ c1: "2", c2: "17440561" });
            })();
            
